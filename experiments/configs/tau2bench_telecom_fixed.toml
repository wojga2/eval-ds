# Tau2Bench Telecom - FIXED VERSION
# Addresses tool confusion issue where chatbot was trying to call user tools
# Run: ./experiments/scripts/run-telecom-eval.sh --focused --config fixed

[options]
# Logging - use beedb for storage, disable wandb
beedb = true
wandb = false
log_wandb_project = "eval-ds"
log_samples = true
log_samples_n = -1  # Log all samples for analysis
make_wandb_report = false

# Execution settings
inspect = false
verbose = true
log_every = 0.5
attempts_per_task = 1  # Single attempt for focused analysis
parallel = 2  # Lower parallelism for detailed logging
shuffle_tasks = false  # Keep deterministic order for analysis

# Version and run name
version = "fixed_preamble_v1"
log_wandb_run_name = "{date} - Tau2Bench_Telecom_FIXED [{estimators}]"

# Summary metrics
[options.summary_metrics.Tau2Bench_Telecom]
"Tau2BenchTask.Telecom:total_reward" = 1

# Estimator defaults (recommended for reasoning models)
# prod = false means use staging API (CO_API_KEY_STAGING)
[estimator-defaults]
k = 0
p = 0.95
temperature = 0.6
thinking_enabled = true
prod = false  # Use staging API

# Task configuration - LIMITED TO 20 TASKS for testing
[task.Tau2BenchTask.Telecom]
domain = "telecom"
num_runs = 1  # Single run for focused analysis
num_truncate = 20  # First 20 tasks for validation

# Estimator with FIXED preamble
[estimator.blobheart.fixed]
model = "c4-prod-run-1"
chat_preamble = """
You are an expert customer service agent for a telecommunications company.
You excel at carefully following instructions and using the available tools precisely.

When handling customer requests:
1. Always verify customer identity first using YOUR available lookup tools (get_customer_by_phone, get_customer_by_id, etc.)
2. Carefully read all account and service details before taking action
3. Confirm with the customer before making any changes to their account
4. Use the minimum number of tool calls needed to complete the task efficiently
5. Pay special attention to billing, plan changes, and technical support issues

IMPORTANT - Understanding Tool Access:
- YOU can directly call: get_customer_by_phone, get_customer_by_id, get_details_by_id, get_data_usage, enable_roaming, refuel_data, transfer_to_human_agents, etc.
- The CUSTOMER can run tools on their device: check_network_status, run_speed_test, toggle_airplane_mode, check_status_bar, etc.

For technical support, the policy describes tools the customer can run on their device.
YOU CANNOT call these customer tools directly. Instead:
- Guide the customer to run the appropriate tool on their device
- Ask them to tell you the results
- Use those results to diagnose and solve their issue
- Example: "Please check your network status and let me know what you see" rather than trying to call check_network_status yourself

Be methodical, accurate, and customer-focused in your approach.
"""

